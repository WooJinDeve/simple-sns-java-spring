## 대용량 시스템에 대한 이해

### 웹 기본 아키텍처

- **관심사 분리, 관측가능한 시스템, 효율적인 리소스 사용**의 중요성이 증가함에 따라 웹 아케텍쳐는 밑에 처럼 분리되었다.
    - **클라이언트**
    - **웹서버** : 정적인 데이터에 관한 처리 담당
    - **웹 어플리케이션 서버** : 동적인 데이터에 관한 처리 담당
    - **데이터베이스**

### 데이터베이스가 병목인 이유

- **서버의 스케일 업과 스케일 아웃**
    - **스케일 업** : 하나의 서버의 사향을 높여 더 많은 요청을 처리하도록 한다
    - **스케일 아웃** : 서버의 수를 증가해 부하를 분산시키도록한다.
- **데이터베이스의 스케일 아웃**
    - 데이터베이스는 데이터라는 상태를 관리하고 있어 서버의 스케일 아웃보다 훨씬 많은 비용이 필요하다.
- **데이터베이스의 데이터 접근 방식**
    - 서버가 메모리에서 데이터를 가져오는 방식과 다르게 데이터베이스는 디스크의 데이터를 접근해서 가져온다

### 대용량 시스템이 어려운 이유

- 하나의 서버로 감당하기 힘들어 대부분 여러개의 서버 또는 데이터베이스를 사용한다
- 여러개의 서버에서 유입되는 데이터의 일관성을 보장할 수 있어야한다
- 코드 한줄이 데이터에 미치는 영향범위가 굉장히 커진다
- 여러 서비스들이 얽혀있어, 시스템 복잡도가 상당히 높다
- **대용량 시스템이 가춰야할 원칙**
    - **고가용성** : 언제든 서비스를 이용할 수 있어야한다.
    - **확장성** : 시스템이 비대해짐에 따라 증가하는 데이터와 트래픽을 대응할 수 있어야한다.
    - **관측가능성** : 문제가 생겼을 때 빠르게 인지할 수 있어야하고 문제의 범위를 최소화할 수 있어야한다.
- **대용량 시스템 아키텍처의 발전과정**
    - **가장 간단한 모델**
        - `클라이언트 → 서버 → 데이터베이스`
    - **간단한 모델 + 스케일 아웃**
        - `클라이언트 → 로드밸런서 → 서버 → 데이터베이스`
            - `NGinx`와 같은 로드밸런서 사용하여 스케일아웃 사용
    - **캐싱 도입**
        - `클라이언트 → 로드밸런서 → 서버 → 캐시, 데이터베이스`
    - **비동기 큐 도입**
        - `클라이언트 → 로드밸런서 → 서버 → 캐시, 데이터베이스 / 비동기큐`
            - 쓰레드, `Kafka`, `Rabbit MQ`